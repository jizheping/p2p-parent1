<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>蓝源Eloan-P2P平台->个人中心</title>
	<link rel="stylesheet" href="/js/bootstrap-3.3.2-dist/css/bootstrap.css" type="text/css" />
	<link rel="stylesheet" href="/css/core.css" type="text/css" />
	<script type="text/javascript" src="/js/jquery/jquery-2.1.3.js"></script>
	<script type="text/javascript" src="/js/bootstrap-3.3.2-dist/js/bootstrap.js"></script>
	<script type="text/javascript" src="/js/jquery.bootstrap.min.js"></script>
	<script type="text/javascript" src="/js/plugins/jquery-validation/jquery.validate.js"></script>
	<script type="text/javascript" src="/js/plugins/jquery-validation/localization/messages_zh.js"></script>
	<script type="text/javascript" src="/js/plugins/jquery.form.js"></script>
	<script type="text/javascript" src="/js/jquery.bootstrap.min.js"></script>
	<script type="text/javascript" src="/js/vue.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

	<style type="text/css">
		.el-login-form{
			width:600px;
			margin-left:auto;
			margin-right:auto;
			margin-top: 20px;
		}
		.el-login-form .form-control{
			width: 220px;
			display: inline;
		}
	</style>



</head>
	<body>


	<div id="app" >
		<div class="el-header">
			<div class="container" style="position: relative;">
				<ul class="nav navbar-nav navbar-right">
					<li><a href="/index.do">首页</a></li>

					<li><a class="el-current-user" href="/personal.html">
						{{loginInfo.username}}
					</a>
					</li>
					<li><a href="/recharge.do"> 账户充值 </a></li>
					<li><a id="logout" href="javascript:void(0);"> 注销 </a></li>
					<li><a href="#">帮助</a></li>
				</ul>
			</div>
		</div>

		<div class="navbar navbar-default el-navbar">
			<div class="container">
				<div class="navbar-header">
					<a href="/">
						<img alt="Brand" src="/images/logo.png">
					</a>
				</div>
				<ul class="nav navbar-nav">
					<li id="index"><a href="/index.html">首页</a></li>
					<li id="invest"><a href="/invest.html">我要投资</a></li>
					<li id="borrow"><a href="/borrow.html">我要借款</a></li>
					<li id="account"><a href="/personal.do">个人中心</a></li>
					<li><a href="#">新手指引</a></li>
					<li><a href="#">关于我们</a></li>
				</ul>
			</div>
		</div>



		<div class="container">
			<div class="row">
				<!--导航菜单-->
				<div class="col-sm-3">
					<ul class="list-group">
						<li class="list-group-item">
							<a href="javascript:;"><span>借贷项目</span></a>
							<ul>
								<li name="bid"><a href="/myBidList.html"><span>投标项目</span></a></li>
								<li name="receive"><a href="/returnmoney_list.html"><span>收款明细</span></a></li>
								<li name="bidRequest"><a href="/myBidRequestList.html"><span>借款项目</span></a></li>
								<li name="borrowBidReturn"><a href="/refundmoney_list.html"><span>还款明细</span></a></li>
							</ul>
						</li>
						<li class="list-group-item">
							<a href="#"><span class="text-title">我的账户</span></a>
							<ul class="in">
								<li name="account" class="active"><a href="/personal.html">账户信息</a></li>
								<li name="realAuth"><a href="/realInfo_result.html">实名认证</a></li>
								<li name="userFile"><a href="/userFile.html">风控资料认证</a></li>
								<li name="bankInfo"><a href="#">银行卡管理</a></li>
								<li name="iplog"><a href="/iplog.html">登录记录</a></li>
								<li name="userInfo"><a href="/basicInfo.html"> <span>个人资料</span></a></li>
							</ul>
						</li>
						<li class="list-group-item">
							<a href="#"><span>资产详情</span></a>
							<ul class="in">
								<li name="accountFlow_list"><a href="">账户流水</a></li>
								<li name="recharge"><a href="#">充值明细</a></li>
								<li name="moneyWithdraw"><a href="#">提现申请</a></li>
							</ul>
						</li>
					</ul>
				</div>
				<!-- 功能页面 -->
				<div class="col-sm-9">
					<div class="panel panel-default">
						<div class="panel-body el-account">
							<div class="el-account-info">
								<div class="pull-left el-head-img">
									<img class="icon" src="images/person_icon.png" />
								</div>
								<div class="pull-left el-head">
									<p>用户名：{{loginInfo.username}}</p>
									<p>最后登录时间：2018-12-25 15:30:10</p>
								</div>
								<div class="pull-left" style="text-align: center;width: 400px;margin:30px auto 0px auto;">
									<a class="btn btn-primary btn-lg" href="/recharge.html">账户充值</a>
									<a class="btn btn-danger btn-lg" href="#">账户提现</a>
								</div>
								<div class="clearfix"></div>
							</div>

							<div class="row h4 account-info">
								<div class="col-sm-4">
									账户总额：<span class="text-primary">{{account.totalAmount}}元</span>
								</div>
								<div class="col-sm-4">
									可用金额：<span class="text-primary">{{account.usableAmount}}元</span>
								</div>
								<div class="col-sm-4">
									冻结金额：<span class="text-primary">{{account.freezedAmount}}元</span>
								</div>
							</div>

							<div class="row h4 account-info">
								<div class="col-sm-4">
									待收利息：<span class="text-primary">{{account.unReceiveInterest}}元</span>
								</div>
								<div class="col-sm-4">
									待收本金：<span class="text-primary">{{account.unReceivePrincipal}}元</span>
								</div>
								<div class="col-sm-4">
									待还本息：<span class="text-primary">{{account.unReturnAmount}}元</span>
								</div>
							</div>

							<div class="el-account-info top-margin">
								<div class="row">
									<div class="col-sm-4">
										<div class="el-accoun-auth">
											<div class="el-accoun-auth-left">
												<img src="images/shiming.png" />
											</div>
											<div class="el-accoun-auth-right">
												<h5>实名认证</h5>
												<p>
													未认证
													<a href="/realAuth.do">马上认证</a>
												</p>
											</div>
											<div class="clearfix"></div>
											<p class="info">实名认证之后才能在平台投资</p>
										</div>
									</div>
									<div class="col-sm-4">
										<div class="el-accoun-auth">
											<div class="el-accoun-auth-left">
												<img src="images/shouji.jpg" />
											</div>
											<div class="el-accoun-auth-right">
												<h5>手机认证</h5>


												<p v-if="userInfo.isBindPhone">
													已认证
													<a href="#">查看</a>
												</p>
												<p  v-if="!userInfo.isBindPhone">
													未认证
													<a @click="showPhoneModal()" href="javascript:;">立刻绑定</a>
												</p>

											</div>
											<div class="clearfix"></div>
											<p class="info">可以收到系统操作信息,并增加使用安全性</p>
										</div>
									</div>
									<div class="col-sm-4">
										<div class="el-accoun-auth">
											<div class="el-accoun-auth-left">
												<img src="images/youxiang.jpg" />
											</div>
											<div class="el-accoun-auth-right">
												<h5>邮箱认证</h5>
												<p v-if="userInfo.isBindEmail">
													已认证
													<a href="#">查看</a>
												</p>
                                                <p  v-if="!userInfo.isBindEmail">
                                                    未认证
                                                    <a id="goto_bindemail" href="javascript:;">立刻绑定</a>
                                                </p>

											</div>
											<div class="clearfix"></div>
											<p class="info">您可以设置邮箱来接收重要信息</p>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-sm-4">
										<div class="el-accoun-auth">
											<div class="el-accoun-auth-left">
												<img src="images/baozhan.jpg" />
											</div>
											<div class="el-accoun-auth-right">
												<h5>VIP会员</h5>
												<p>
													普通用户
													<a href="#">查看</a>
												</p>
											</div>
											<div class="clearfix"></div>
											<p class="info">VIP会员，让你更快捷的投资</p>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="bindPhoneModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="exampleModalLabel">绑定手机</h4>
					</div>
					<div class="modal-body">
						<form class="form-horizontal" id="bindForm" >
							<div class="form-group">
								<label for="phoneNumber" class="col-sm-2 control-label">手机号:</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="phoneNumber" v-model="smMsgVo.phone" />
									<button class="btn btn-primary" type="button" v-text="sendCodeText"></button>
								</div>
							</div>
							<div class="form-group">
								<label for="verifyCode" class="col-sm-2 control-label">验证码:</label>
								<div class="col-sm-4">
									<input type="text" class="form-control" id="verifyCode" v-model="smMsgVo.verifyCode" />
								</div>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button type="button" class="btn btn-primary">提交</button>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="bindEmailModal" tabindex="-1" role="dialog" aria-labelledby="bindEmailModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="bindEmailModalLabel">绑定邮箱</h4>
					</div>
					<div class="modal-body">
						<form class="form-horizontal" id="bindEmailForm" >
							<div class="form-group">
								<label for="email" class="col-sm-2 control-label">邮箱地址:</label>
								<div class="col-sm-6">
									<input type="text" class="form-control" id="email" v-model="email" />
								</div>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button type="button" class="btn btn-primary">发送验证邮件</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- 网页版权 -->
	<div class="container-foot-2">
		<div class="context">
			<div class="left">
				<p>版权所有：&emsp;2018xxx科技有限公司</p>
				<p>地&emsp;&emsp;址：&emsp;上海市奉贤区xxx街道xx号</p>
				<p>电&emsp;&emsp;话：021-xxxxxx&emsp;&emsp;
					邮箱：&emsp;xxx@163.com</p>
				<p>
					<a href="http://www.baidu.com" style="color: #ffffff">ICP备案
						：沪ICP备字521</a>
				</p>
			</div>
			<div class="right">
				<a target="_blank" href="https://www.infoq.cn/"><img
						src="/images/sina.png"></a>
			</div>
			<div class="clearfix"></div>
		</div>
	</div>


</body>
</html>

<script type="text/javascript">

    var vue = new Vue({
        el:"#app",
        data:{
            loginInfo:"",  //账号信息
            userInfo:"",  //用户信息
            account:"",    //账户信息
            email:"",
            smMsgVo:{
                phone:"",
                verifyCode:"",
                userId:""
            },
            sendCodeText:"发送验证码",
            codeTextSecond:6,
            sendCodeEnable:false
        },
        methods:{
            //加载账户信息
            loadAccount:function (userId) {
                //发送ajax请求
                //axios发送请求时携带cookie
                axios.defaults.withCredentials=true;
                axios({
                    method:"GET",
                    url:"http://api.p2p.com/account/account/detail",
                    params:{userId:userId}
                }).then(function(resp){
                    console.log(resp.data);
                    var resultVo = resp.data;
                    if(resultVo.code == 0){
                        //账户信息
                        vue.account = resultVo.data;

                    }else{
                        $.messager.alert("提示",resultVo.msg);
                        window.location.href = "http://www.p2p.com/login.html";
                    }

                });
            },
            //加载用户信息
            loadUserInfo:function (userId) {
                //发送ajax请求
                //axios发送请求时携带cookie
                axios.defaults.withCredentials=true;
                axios(
                    "http://api.p2p.com/user/personal/getUserMessage",
					{params:{userId:userId}}
                ).then(function(resp){
                    console.log(resp.data);
                    var resultVo = resp.data;
                    if(resultVo.code == 0){
                        //用户信息
                        vue.userInfo = resultVo.data;
                    }else{
                        $.messager.alert("提示",resultVo.msg);
                        //window.location.href = "http://www.p2p.com/login.html";
                    }

                });
            }

        },
        mounted:function () {
            //发送ajax请求
            //axios发送请求时携带cookie
            axios.defaults.withCredentials=true;
            axios({
                method:"POST",
                url:"http://api.p2p.com/user/user/checkLogin"
            }).then(function(resp){
                var resultVo = resp.data;
                if(resultVo.code == 0){
                    //账号信息
                    vue.loginInfo = resultVo.data;
                    vue.loadAccount(vue.loginInfo.id);
                    vue.loadUserInfo(vue.loginInfo.id);
                }else{
                    $.messager.alert("提示",resultVo.msg);
                    window.location.href = "http://www.p2p.com/login.html";
                }
            });
        }
    });
</script>